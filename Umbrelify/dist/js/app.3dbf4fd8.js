(function(){"use strict";var e={6056:function(e,t,a){a.d(t,{I:function(){return l},db:function(){return c}});var n=a(4275),i=a(6816),r=a(6035);const o={apiKey:"AIzaSyAkfyeLx1NBJBiwnnN55ES06fqIZHDKZO0",authDomain:"umbrellify.firebaseapp.com",projectId:"umbrellify",storageBucket:"umbrellify.appspot.com",messagingSenderId:"267114931166",appId:"1:267114931166:web:10885ae4baa51b3a69b34f"},s=(0,n.ZF)(o),l=(0,i.v0)(s),c=(0,r.ad)(s);(0,i.Fb)(l,i.a$)},6970:function(e,t,a){var n=a(9242),i=a(3396),r=a(4870),o=a(7139),s=a(2483);const l={id:"navbar",class:"navbar navbar-expand-lg navbar-dark bg-dark"},c={class:"container-fluid"},d=(0,i._)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarTogglerDemo01","aria-controls":"navbarTogglerDemo01","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,i._)("span",{class:"navbar-toggler-icon"})],-1),u={class:"collapse navbar-collapse",id:"navbarTogglerDemo01"},m={class:"navbar-nav me-auto mb-2 mb-lg-0"},h={class:"nav-item"},p={class:"nav-item"},v={class:"nav-item"},f={class:"nav-item"},g={class:"nav-item"};function b(e,t){const a=(0,i.up)("router-link");return(0,i.wg)(),(0,i.iD)("nav",l,[(0,i._)("div",c,[d,(0,i._)("div",u,[(0,i.Wm)(a,{class:"navbar-brand",to:"/"},{default:(0,i.w5)((()=>[(0,i.Uk)("Umbrellify")])),_:1}),(0,i._)("ul",m,[(0,i._)("li",h,[(0,i.Wm)(a,{class:"nav-link",to:"/"},{default:(0,i.w5)((()=>[(0,i.Uk)("Home")])),_:1})]),(0,i._)("li",p,[(0,i.Wm)(a,{class:"nav-link",to:"/forecast"},{default:(0,i.w5)((()=>[(0,i.Uk)("Forecast")])),_:1})]),(0,i._)("li",v,[(0,i.Wm)(a,{class:"nav-link",to:"/leaderboard"},{default:(0,i.w5)((()=>[(0,i.Uk)("Leaderboard")])),_:1})]),(0,i._)("li",f,[(0,i.Wm)(a,{class:"nav-link",to:"/profile"},{default:(0,i.w5)((()=>[(0,i.Uk)("Profile")])),_:1})]),(0,i._)("li",g,[(0,i.Wm)(a,{class:"nav-link",to:"/login",onClick:t[0]||(t[0]=t=>e.$store.dispatch("logout"))},{default:(0,i.w5)((()=>[(0,i.Uk)("Logout")])),_:1})])])])])])}var y=a(89);const w={},_=(0,y.Z)(w,[["render",b]]);var T=_,k=a(6816);const S={key:0,class:"wrapper",id:"nav"},U={class:"wrapper"},I={setup(){const e=(0,o.oR)();(0,i.wF)((()=>{e.dispatch("fetchUser")}))}};var E=Object.assign(I,{__name:"App",setup(e){const t=(0,r.iH)(!1);let a;return(0,i.bv)((()=>{a=(0,k.v0)(),(0,k.Aj)(a,(e=>{t.value=!!e}))})),(e,a)=>((0,i.wg)(),(0,i.iD)(i.HY,null,[t.value?((0,i.wg)(),(0,i.iD)("div",S,[(0,i._)("header",null,[(0,i._)("div",U,[(0,i.Wm)(T)])])])):(0,i.kq)("",!0),(0,i.Wm)((0,r.SU)(s.MA))],64))}});const C=(0,y.Z)(E,[["__scopeId","data-v-5683f13d"]]);var A=C,D=(a(7658),a(2268)),R=a(6035),j=a(6056),O=a(70);const x={id:"input"},L={class:"container"},N={class:"row my-3"},M={class:"my-1 col-12 col-md-6 col-lg-2"},J=(0,i._)("label",{class:"text-light"},"Start Time",-1),P={class:"my-1 col-12 col-md-6 col-lg-2"},q=(0,i._)("label",{class:"text-light"},"End Time",-1),W={class:"my-1 col-12 col-md-6 col-lg-4"},B={class:"my-1 col-12 col-md-6 col-lg-3"},$={class:"my-1 col-12 col-lg-1 d-grid"},F=["disabled"],H={class:"container"},Z={class:"row"},z={class:"col",style:{"overflow-x":"auto"}},K={key:0,class:"table table-dark table-striped table-bordered"},V=(0,i._)("thead",null,[(0,i._)("tr",{scope:"row"},[(0,i._)("th",{scope:"col"},"There are no activities.")])],-1),Y=[V],Q={key:1,class:"table table-dark table-striped table-bordered"},X=(0,i._)("thead",null,[(0,i._)("tr",{scope:"row"},[(0,i._)("th",{scope:"col",class:"text-center"},"Start Time"),(0,i._)("th",{scope:"col",class:"text-center"},"End Time"),(0,i._)("th",{scope:"col"},"Location in Singapore"),(0,i._)("th",{scope:"col"},"Activity"),(0,i._)("th",{scope:"col",class:"text-center"},"Delete")])],-1),G={scope:"col",class:"text-center"},ee={scope:"col",class:"text-center"},te={scope:"col"},ae={scope:"col"},ne={scope:"col",class:"justify-content-center text-center align-self-center"},ie=["onClick"],re={data(){return{location:"",startTime:null,endTime:null,activityName:"",dbCollec:[],toDoEmpty:!1,dateStr:"",region:"",todos:null,user:null,periods:[]}},created(){this.todos=(0,r.iH)([]);const e=new Date,t=e.getFullYear(),a=e.getMonth()+1,n=e.getDate();this.dateStr=`${t}-${a}-${n}`,this.user=j.I.currentUser;const i=(0,R.hJ)(j.db,this.user.email),o=(0,R.IO)((0,R.hJ)(i,this.dateStr,"activities"),(0,R.Xo)("startTime","asc"));(0,R.cf)(o,(e=>{const t=[];e.empty?this.toDoEmpty=!0:(e.forEach((e=>{const a={id:e.id,startTime:e.data().startTime,endTime:e.data().endTime,location:e.data().location,lat:e.data().lat,lng:e.data().lng,activityName:e.data().activityName,done:e.data().done};t.push(a)})),this.todos.value=t)}))},methods:{async addRainCount(){var e=j.I.currentUser,t=e.uid;const a=(0,R.JU)(j.db,"UserInfo",t),n=await(0,R.QT)(a);var i=n.data().rain_event_count;i+=1,(0,R.r7)((0,R.JU)(j.db,"UserInfo",t),{rain_event_count:i})},async deleteRainCount(e){var t=j.I.currentUser,a=t.uid;const n=(0,R.hJ)(j.db,this.user.email),i=(0,R.JU)((0,R.hJ)(n,this.dateStr,"activities"),e),r=await(0,R.QT)(i);var o=r.data().isRain;if(1==o){const e=(0,R.JU)(j.db,"UserInfo",a),t=await(0,R.QT)(e);var s=t.data().rain_event_count;s-=1,(0,R.r7)((0,R.JU)(j.db,"UserInfo",a),{rain_event_count:s})}(0,R.oe)((0,R.JU)((0,R.hJ)(n,this.dateStr,"activities"),e))},handleLocation(){this.getData();const e=this.$refs.locationRef.value;this.location=`${e.toUpperCase()}`;let t=document.getElementById("pac-input").value;var a="AIzaSyBkkRWl9rc5Ukq4suqBUscKqy9nY4ah-e8",n="https://maps.googleapis.com/maps/api/geocode/json?";O.ZP.get(n,{params:{address:t,key:a}}).then((e=>{j.I.currentUser;const t=e.data.results[0].geometry.location.lat,a=e.data.results[0].geometry.location.lng;this.region=this.getRegion(t,a);var n=null;const i=`${this.dateStr}T${this.startTime}:00`,r=`${this.dateStr}T${this.endTime}:00`;this.region.toLowerCase();O.ZP.get("https://api.data.gov.sg/v1/environment/24-hour-weather-forecast",{params:{date_time:i}}).then((e=>{this.periods=e.data.items[0].periods;var o={};const s=Date.parse(i),l=Date.parse(r);var c=!1,d=!1;for(let t=0;t<this.periods.length;t++){const e=Date.parse(this.periods[t].time.start),a=Date.parse(this.periods[t].time.end);if(e<=s&&s<a&&(c=!0),e<l&&l<=a&&(d=!0),c){o[t]=this.periods[t];for(const e in this.periods[t].regions)if(e==this.region){let a={};a[e]=this.periods[t].regions[e],o[t].regions=a}c&&d&&(this.periods=[o[t]],n=this.getWorstScenario())}}if(this.invalidInterval(this.startTime,this.endTime)&&this.startTimeChecker(this.startTime)&&this.endTimeChecker(this.endTime)){const e=(0,R.hJ)(j.db,this.user.email);(0,R.ET)((0,R.hJ)(e,this.dateStr,"activities"),{startTime:this.startTime,endTime:this.endTime,location:this.location,activityName:this.activityName,lat:t,lng:a,region:this.region,date:Date.now(),isRain:n}),1==n&&this.addRainCount(),this.startTime="",this.endTime="",document.getElementById("pac-input").value="",this.activityName="",this.toDoEmpty=!1}}))})).catch((e=>{console.log(e.message)}))},getRegion(e,t){const a=[1.45,103.82],n=[1.37,103.97],i=[1.28,103.82],r=[1.35,103.68],o=[1.38,103.79];var s="";function l(e,t,a,n){a=a*Math.PI/180,n=n*Math.PI/180,e=e*Math.PI/180,t=t*Math.PI/180;let i=n-a,r=t-e,o=Math.pow(Math.sin(r/2),2)+Math.cos(e)*Math.cos(t)*Math.pow(Math.sin(i/2),2),s=2*Math.asin(Math.sqrt(o)),l=6371;return s*l}let c=l(e,a[0],t,a[1]),d=l(e,n[0],t,n[1]),u=l(e,i[0],t,i[1]),m=l(e,r[0],t,r[1]),h=l(e,o[0],t,o[1]),p=Math.min(c,d,u,m,h);return s=c==p?"North":d==p?"East":u==p?"South":m==p?"West":"Central",s},getData(){const e=(0,R.hJ)(j.db,this.user.email);(0,R.cf)((0,R.hJ)(e,this.dateStr,"activities"),(e=>{e.forEach((e=>{const t={id:e.id,startTime:e.data().startTime,endTime:e.data().endTime};this.dbCollec.push(t)}))}))},getWorstScenario(){var e=[{rank:1,weather:"Thundery Showers"},{rank:2,weather:"Showers"},{rank:3,weather:"Light Rain"},{rank:4,weather:"Cloudy"}],t=Number.MAX_VALUE;const a=this.region.toLowerCase();var n="";if(1==Object.keys(this.periods).length)n=this.periods[0].regions[a];else for(const i in this.periods)for(const r of e)r.rank<t&&r.weather==this.periods[i].regions[a]&&(t=r.rank,n=r.weather);return n.toLowerCase().includes("showers")||n.toLowerCase().includes("rain")?1:0},deleteActivity(e){this.deleteRainCount(e)},invalidInterval(e,t){return!(t<e)||(alert("Invalid input, End Time is earlier than Start Time"),!1)},startTimeChecker(e){for(let t in this.dbCollec)if(e===this.dbCollec[t].startTime)return alert("Crashing Start Time"),!1;return!0},endTimeChecker(e){for(let t in this.dbCollec)if(e===this.dbCollec[t].endTime)return alert("Crashing End Time"),!1;return!0},allInputsFilled(){return null!=this.startTime&&(null!=this.endTime&&(0!=document.getElementById("pac-input").value.length&&""!=this.activityName))}}};var oe=Object.assign(re,{__name:"InputField",setup(e){var t=j.I.currentUser;t.email;const a=(0,r.iH)([]),o=(0,r.iH)();var s;return(0,i.bv)((()=>{let e=new google.maps.places.Autocomplete(o.value,{componentRestrictions:{country:"SG"},types:["establishment"],fields:["address_components"]});e.getPlace()})),(0,i.Ah)((()=>{s&&google.maps.event.clearInstanceListeners(s)})),(e,t)=>((0,i.wg)(),(0,i.iD)("main",x,[(0,i._)("div",L,[(0,i._)("div",N,[(0,i._)("div",M,[(0,i.wy)((0,i._)("input",{type:"time","onUpdate:modelValue":t[0]||(t[0]=e=>(0,r.dq)(startTime)?startTime.value=e:null),class:"form-control",placeholder:"Start Time"},null,512),[[n.nr,e.startTime]]),J]),(0,i._)("div",P,[(0,i.wy)((0,i._)("input",{type:"time","onUpdate:modelValue":t[1]||(t[1]=e=>(0,r.dq)(endTime)?endTime.value=e:null),class:"form-control",placeholder:"End Time"},null,512),[[n.nr,e.endTime]]),q]),(0,i._)("div",W,[(0,i._)("input",{type:"text",id:"pac-input",class:"form-control",placeholder:"Location in Singapore",ref_key:"locationRef",ref:o},null,512)]),(0,i._)("div",B,[(0,i.wy)((0,i._)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>(0,r.dq)(activityName)?activityName.value=e:null),class:"form-control",placeholder:"Activity"},null,512),[[n.nr,e.activityName]])]),(0,i._)("div",$,[(0,i._)("button",{onClick:t[3]||(t[3]=(...t)=>e.handleLocation&&e.handleLocation(...t)),disabled:!e.allInputsFilled(),class:"btn btn-primary",style:{height:"38px"}}," Add ",8,F)])])]),(0,i._)("div",H,[(0,i._)("div",Z,[(0,i._)("div",z,[e.toDoEmpty?((0,i.wg)(),(0,i.iD)("table",K,Y)):((0,i.wg)(),(0,i.iD)("table",Q,[X,(0,i._)("tbody",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.value.value,(t=>((0,i.wg)(),(0,i.iD)("tr",{class:(0,D.C_)({"bg-success":t.done}),key:t.activityName},[(0,i._)("td",G,(0,D.zw)(t.startTime),1),(0,i._)("td",ee,(0,D.zw)(t.endTime),1),(0,i._)("td",te,(0,D.zw)(t.location),1),(0,i._)("td",ae,(0,D.zw)(t.activityName),1),(0,i._)("td",ne,[(0,i._)("button",{onClick:a=>e.deleteActivity(t.id),class:"btn btn-danger"}," Delete ",8,ie)])],2)))),128))])]))])])])]))}});const se=oe;var le=se;const ce={id:"home"};var de={__name:"HomeView",setup(e){return(e,t)=>((0,i.wg)(),(0,i.iD)("main",ce,[(0,i._)("div",null,[(0,i.Wm)(le)])]))}};const ue=de;var me=ue;const he=[{path:"/",name:"home",component:me,meta:{requiresAuth:!0}},{path:"/profile",name:"profile",component:()=>a.e(580).then(a.bind(a,2580)),meta:{requiresAuth:!0}},{path:"/leaderboard",name:"leaderboard",component:()=>a.e(707).then(a.bind(a,8707)),meta:{requiresAuth:!0}},{path:"/login",name:"login",component:()=>a.e(900).then(a.bind(a,3129))},{path:"/forecast",name:"forecast",component:()=>a.e(489).then(a.bind(a,7489)),meta:{requiresAuth:!0}},{path:"/register",name:"register",component:()=>a.e(241).then(a.bind(a,832))}],pe=()=>new Promise(((e,t)=>{const a=(0,k.Aj)((0,k.v0)(),(t=>{a(),e(t)}),t)})),ve=(0,s.p7)({history:(0,s.PO)("/"),routes:he});ve.beforeEach((async(e,t,a)=>{e.matched.some((e=>e.meta.requiresAuth))?await pe()?a():a("/login"):a()}));var fe=ve,ge=(0,o.MT)({state:{user:null},mutations:{SET_USER(e,t){e.user=t},CLEAR_USER(e){e.user=null}},actions:{async login({commit:e},t){const{email:a,password:n}=t;try{await(0,k.e5)(j.I,a,n)}catch(i){switch(i.code){case"auth/user-not-found":alert("User not found");break;case"auth/wrong-password":alert("Wrong password");break;default:alert("Something went wrong")}return}e("SET_USER",j.I.currentUser),fe.push("/")},async register({commit:e},t){const{email:a,password:n}=t;try{await(0,k.Xb)(j.I,a,n)}catch(s){switch(s.code){case"auth/email-already-in-use":alert("Email already in use");break;case"auth/invalid-email":alert("Invalid email");break;case"auth/operation-not-allowed":alert("Operation not allowed");break;case"auth/weak-password":alert("Weak password");break;default:alert("Something went wrong")}return}e("SET_USER",j.I.currentUser);var i=j.I.currentUser,r=i.uid,o=i.email;(0,R.pl)((0,R.JU)(j.db,"UserInfo",r),{username:t.username,gender:t.gender,email:o,rain_event_count:0}),fe.push("/")},async logout({commit:e}){await(0,k.w7)(j.I),e("CLEAR_USER"),fe.push("/login")},fetchUser({commit:e}){j.I.onAuthStateChanged((async t=>{null==t?e("CLEAR_USER"):(e("SET_USER",t),fe.isReady()&&"/login"===fe.currentRoute.value.path&&fe.push("/"))}))}}}),be=(a(5654),a(5365)),ye=a(5109),we=a.n(ye);(0,n.ri)(A).use(ge).use(fe).use(be.ZP,{load:{key:"AIzaSyAkfyeLx1NBJBiwnnN55ES06fqIZHDKZO0"}}).use(we()).mount("#app")}},t={};function a(n){var i=t[n];if(void 0!==i)return i.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,a),r.exports}a.m=e,function(){var e=[];a.O=function(t,n,i,r){if(!n){var o=1/0;for(d=0;d<e.length;d++){n=e[d][0],i=e[d][1],r=e[d][2];for(var s=!0,l=0;l<n.length;l++)(!1&r||o>=r)&&Object.keys(a.O).every((function(e){return a.O[e](n[l])}))?n.splice(l--,1):(s=!1,r<o&&(o=r));if(s){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[n,i,r]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.f={},a.e=function(e){return Promise.all(Object.keys(a.f).reduce((function(t,n){return a.f[n](e,t),t}),[]))}}(),function(){a.u=function(e){return"js/"+e+"."+{241:"3da08661",489:"65f52bff",580:"6038709f",707:"a261810d",900:"e6650c66"}[e]+".js"}}(),function(){a.miniCssF=function(e){}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="project:";a.l=function(n,i,r,o){if(e[n])e[n].push(i);else{var s,l;if(void 0!==r)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+r){s=u;break}}s||(l=!0,s=document.createElement("script"),s.charset="utf-8",s.timeout=120,a.nc&&s.setAttribute("nonce",a.nc),s.setAttribute("data-webpack",t+r),s.src=n),e[n]=[i];var m=function(t,a){s.onerror=s.onload=null,clearTimeout(h);var i=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((function(e){return e(a)})),t)return t(a)},h=setTimeout(m.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=m.bind(null,s.onerror),s.onload=m.bind(null,s.onload),l&&document.head.appendChild(s)}}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.p="/"}(),function(){var e={143:0};a.f.j=function(t,n){var i=a.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var r=new Promise((function(a,n){i=e[t]=[a,n]}));n.push(i[2]=r);var o=a.p+a.u(t),s=new Error,l=function(n){if(a.o(e,t)&&(i=e[t],0!==i&&(e[t]=void 0),i)){var r=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",s.name="ChunkLoadError",s.type=r,s.request=o,i[1](s)}};a.l(o,l,"chunk-"+t,t)}},a.O.j=function(t){return 0===e[t]};var t=function(t,n){var i,r,o=n[0],s=n[1],l=n[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(i in s)a.o(s,i)&&(a.m[i]=s[i]);if(l)var d=l(a)}for(t&&t(n);c<o.length;c++)r=o[c],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(d)},n=self["webpackChunkproject"]=self["webpackChunkproject"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(6970)}));n=a.O(n)})();
//# sourceMappingURL=app.3dbf4fd8.js.map